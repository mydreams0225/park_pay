!function(n,t){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return t(n)}):t(n,!0)}(this,function(n,t){function i(t,i,r){n.WeixinJSBridge?WeixinJSBridge.invoke(t,tt(i),function(n){rt(t,n,r)}):p(t,r)}function o(t,i,r){n.WeixinJSBridge?WeixinJSBridge.on(t,function(n){r&&r.trigger&&r.trigger(n);rt(t,n,i)}):r?p(t,r):p(t,i)}function tt(n){return n=n||{},n.appId=f.appId,n.verifyAppId=f.appId,n.verifySignType="sha1",n.verifyTimestamp=f.timestamp+"",n.verifyNonceStr=f.nonceStr,n.verifySignature=f.signature,n}function it(n){return{timeStamp:n.timestamp+"",nonceStr:n.nonceStr,package:n.package,paySign:n.paySign,signType:n.signType||"SHA1"}}function ht(n){return n.postalCode=n.addressPostalCode,delete n.addressPostalCode,n.provinceName=n.proviceFirstStageName,delete n.proviceFirstStageName,n.cityName=n.addressCitySecondStageName,delete n.addressCitySecondStageName,n.countryName=n.addressCountiesThirdStageName,delete n.addressCountiesThirdStageName,n.detailInfo=n.addressDetailInfo,delete n.addressDetailInfo,n}function rt(n,t,i){var r,u,e;"openEnterpriseChat"==n&&(t.errCode=t.err_code);delete t.err_code;delete t.err_desc;delete t.err_detail;r=t.errMsg;r||(r=t.err_msg,delete t.err_msg,r=ct(n,r),t.errMsg=r);i=i||{};i._complete&&(i._complete(t),delete i._complete);r=t.errMsg||"";f.debug&&!i.isInnerInvoke&&console.log(JSON.stringify(t));u=r.indexOf(":");e=r.substring(u+1);switch(e){case"ok":i.success&&i.success(t);break;case"cancel":i.cancel&&i.cancel(t);break;default:i.fail&&i.fail(t)}i.complete&&i.complete(t)}function ct(n,t){var r=n,u=b[r],i,f;return u&&(r=u),i="ok",t&&(f=t.indexOf(":"),i=t.substring(f+1),"confirm"==i&&(i="ok"),"failed"==i&&(i="fail"),-1!=i.indexOf("failed_")&&(i=i.substring(7)),-1!=i.indexOf("fail_")&&(i=i.substring(5)),i=i.replace(/_/g," "),i=i.toLowerCase(),("access denied"==i||"no permission to execute"==i)&&(i="permission denied"),"config"==r&&"function not exist"==i&&(i="ok"),""==i&&(i="fail")),r+":"+i}function ut(n){var t,u,f,i;if(n){for(t=0,u=n.length;u>t;++t)f=n[t],i=r[f],i&&(n[t]=i);return n}}function p(n,t){if(!(!f.debug||t&&t.isInnerInvoke)){var i=b[n];i&&(n=i);t&&t._complete&&delete t._complete;console.log('"'+n+'",',t||"")}}function lt(){if(!(vt||yt||f.debug||"6.0.2">k||u.systemType<0)){var n=new Image;u.appId=f.appId;u.initTime=h.initEndTime-h.initStartTime;u.preVerifyTime=h.preVerifyEndTime-h.preVerifyStartTime;a.getNetworkType({isInnerInvoke:!0,success:function(t){u.networkType=t.networkType;var i="https://open.weixin.qq.com/sdk/report?v="+u.version+"&o="+u.isPreVerifyOk+"&s="+u.systemType+"&c="+u.clientVersion+"&a="+u.appId+"&n="+u.networkType+"&i="+u.initTime+"&p="+u.preVerifyTime+"&u="+u.url;n.src=i}})}}function w(){return(new Date).getTime()}function ft(t){ot&&(n.WeixinJSBridge?t():v.addEventListener&&v.addEventListener("WeixinJSBridgeReady",t,!1))}function at(){a.invoke||(a.invoke=function(t,i,r){n.WeixinJSBridge&&WeixinJSBridge.invoke(t,tt(i),r)},a.on=function(t,i){n.WeixinJSBridge&&WeixinJSBridge.on(t,i)})}if(!n.jWeixin){var r={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress"},b=function(){var n={};for(var t in r)n[r[t]]=t;return n}(),v=n.document,l=v.title,s=navigator.userAgent.toLowerCase(),et=navigator.platform.toLowerCase(),vt=!(!et.match("mac")&&!et.match("win")),yt=-1!=s.indexOf("wxdebugger"),ot=-1!=s.indexOf("micromessenger"),y=-1!=s.indexOf("android"),st=-1!=s.indexOf("iphone")||-1!=s.indexOf("ipad"),k=function(){var n=s.match(/micromessenger\/(\d+\.\d+\.\d+)/)||s.match(/micromessenger\/(\d+\.\d+)/);return n?n[1]:""}(),h={initStartTime:w(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},u={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:st?1:y?2:-1,clientVersion:k,url:encodeURIComponent(location.href)},f={},e={_completes:[]},c={state:0,data:{}};ft(function(){h.initEndTime=w()});var d=!1,g=[],a={config:function(n){f=n;p("config",n);var t=f.check===!1?!1:!0;ft(function(){if(t)i(r.config,{verifyJsApiList:ut(f.jsApiList)},function(){e._complete=function(n){h.preVerifyEndTime=w();c.state=1;c.data=n};e.success=function(){u.isPreVerifyOk=0};e.fail=function(n){e._fail?e._fail(n):c.state=-1};var n=e._completes;return n.push(function(){lt()}),e.complete=function(){for(var t=0,i=n.length;i>t;++t)n[t]();e._completes=[]},e}()),h.preVerifyStartTime=w();else{c.state=1;for(var o=e._completes,n=0,s=o.length;s>n;++n)o[n]();e._completes=[]}});f.beta&&at()},ready:function(n){0!=c.state?n():(e._completes.push(n),!ot&&f.debug&&n())},error:function(n){"6.0.2">k||(-1==c.state?n(c.data):e._fail=n)},checkJsApi:function(n){var t=function(n){var t=n.checkResult,i,r;for(i in t)r=b[i],r&&(t[r]=t[i],delete t[i]);return n};i("checkJsApi",{jsApiList:ut(n.jsApiList)},function(){return n._complete=function(n){if(y){var i=n.checkResult;i&&(n.checkResult=JSON.parse(i))}n=t(n)},n}())},onMenuShareTimeline:function(n){o(r.onMenuShareTimeline,{complete:function(){i("shareTimeline",{title:n.title||l,desc:n.title||l,img_url:n.imgUrl||"",link:n.link||location.href,type:n.type||"link",data_url:n.dataUrl||""},n)}},n)},onMenuShareAppMessage:function(n){o(r.onMenuShareAppMessage,{complete:function(){i("sendAppMessage",{title:n.title||l,desc:n.desc||"",link:n.link||location.href,img_url:n.imgUrl||"",type:n.type||"link",data_url:n.dataUrl||""},n)}},n)},onMenuShareQQ:function(n){o(r.onMenuShareQQ,{complete:function(){i("shareQQ",{title:n.title||l,desc:n.desc||"",img_url:n.imgUrl||"",link:n.link||location.href},n)}},n)},onMenuShareWeibo:function(n){o(r.onMenuShareWeibo,{complete:function(){i("shareWeiboApp",{title:n.title||l,desc:n.desc||"",img_url:n.imgUrl||"",link:n.link||location.href},n)}},n)},onMenuShareQZone:function(n){o(r.onMenuShareQZone,{complete:function(){i("shareQZone",{title:n.title||l,desc:n.desc||"",img_url:n.imgUrl||"",link:n.link||location.href},n)}},n)},startRecord:function(n){i("startRecord",{},n)},stopRecord:function(n){i("stopRecord",{},n)},onVoiceRecordEnd:function(n){o("onVoiceRecordEnd",n)},playVoice:function(n){i("playVoice",{localId:n.localId},n)},pauseVoice:function(n){i("pauseVoice",{localId:n.localId},n)},stopVoice:function(n){i("stopVoice",{localId:n.localId},n)},onVoicePlayEnd:function(n){o("onVoicePlayEnd",n)},uploadVoice:function(n){i("uploadVoice",{localId:n.localId,isShowProgressTips:0==n.isShowProgressTips?0:1},n)},downloadVoice:function(n){i("downloadVoice",{serverId:n.serverId,isShowProgressTips:0==n.isShowProgressTips?0:1},n)},translateVoice:function(n){i("translateVoice",{localId:n.localId,isShowProgressTips:0==n.isShowProgressTips?0:1},n)},chooseImage:function(n){i("chooseImage",{scene:"1|2",count:n.count||9,sizeType:n.sizeType||["original","compressed"],sourceType:n.sourceType||["album","camera"]},function(){return n._complete=function(n){if(y){var t=n.localIds;t&&(n.localIds=JSON.parse(t))}},n}())},getLocation:function(){},previewImage:function(n){i(r.previewImage,{current:n.current,urls:n.urls},n)},uploadImage:function(n){i("uploadImage",{localId:n.localId,isShowProgressTips:0==n.isShowProgressTips?0:1},n)},downloadImage:function(n){i("downloadImage",{serverId:n.serverId,isShowProgressTips:0==n.isShowProgressTips?0:1},n)},getLocalImgData:function(n){d===!1?(d=!0,i("getLocalImgData",{localId:n.localId},function(){return n._complete=function(){if(d=!1,g.length>0){var n=g.shift();wx.getLocalImgData(n)}},n}())):g.push(n)},getNetworkType:function(n){var t=function(n){var r=n.errMsg,t,u,i;if(n.errMsg="getNetworkType:ok",t=n.subtype,delete n.subtype,t)n.networkType=t;else{u=r.indexOf(":");i=r.substring(u+1);switch(i){case"wifi":case"edge":case"wwan":n.networkType=i;break;default:n.errMsg="getNetworkType:fail"}}return n};i("getNetworkType",{},function(){return n._complete=function(n){n=t(n)},n}())},openLocation:function(n){i("openLocation",{latitude:n.latitude,longitude:n.longitude,name:n.name||"",address:n.address||"",scale:n.scale||28,infoUrl:n.infoUrl||""},n)},getLocation:function(n){n=n||{};i(r.getLocation,{type:n.type||"wgs84"},function(){return n._complete=function(n){delete n.type},n}())},hideOptionMenu:function(n){i("hideOptionMenu",{},n)},showOptionMenu:function(n){i("showOptionMenu",{},n)},closeWindow:function(n){n=n||{};i("closeWindow",{},n)},hideMenuItems:function(n){i("hideMenuItems",{menuList:n.menuList},n)},showMenuItems:function(n){i("showMenuItems",{menuList:n.menuList},n)},hideAllNonBaseMenuItem:function(n){i("hideAllNonBaseMenuItem",{},n)},showAllNonBaseMenuItem:function(n){i("showAllNonBaseMenuItem",{},n)},scanQRCode:function(n){n=n||{};i("scanQRCode",{needResult:n.needResult||0,scanType:n.scanType||["qrCode","barCode"]},function(){return n._complete=function(n){var i,t;st&&(i=n.resultStr,i&&(t=JSON.parse(i),n.resultStr=t&&t.scan_code&&t.scan_code.scan_result))},n}())},openAddress:function(n){i(r.openAddress,{},function(){return n._complete=function(n){n=ht(n)},n}())},openProductSpecificView:function(n){i(r.openProductSpecificView,{pid:n.productId,view_type:n.viewType||0,ext_info:n.extInfo},n)},addCard:function(n){for(var u,o,f=n.cardList,e=[],t=0,s=f.length;s>t;++t)u=f[t],o={card_id:u.cardId,card_ext:u.cardExt},e.push(o);i(r.addCard,{card_list:e},function(){return n._complete=function(n){var i=n.card_list,r,u,t;if(i){for(i=JSON.parse(i),r=0,u=i.length;u>r;++r)t=i[r],t.cardId=t.card_id,t.cardExt=t.card_ext,t.isSuccess=t.is_succ?!0:!1,delete t.card_id,delete t.card_ext,delete t.is_succ;n.cardList=i;delete n.card_list}},n}())},chooseCard:function(n){i("chooseCard",{app_id:f.appId,location_id:n.shopId||"",sign_type:n.signType||"SHA1",card_id:n.cardId||"",card_type:n.cardType||"",card_sign:n.cardSign,time_stamp:n.timestamp+"",nonce_str:n.nonceStr},function(){return n._complete=function(n){n.cardList=n.choose_card_info;delete n.choose_card_info},n}())},openCard:function(n){for(var u,o,f=n.cardList,e=[],t=0,s=f.length;s>t;++t)u=f[t],o={card_id:u.cardId,code:u.code},e.push(o);i(r.openCard,{card_list:e},n)},consumeAndShareCard:function(n){i(r.consumeAndShareCard,{consumedCardId:n.cardId,consumedCode:n.code},n)},chooseWXPay:function(n){i(r.chooseWXPay,it(n),n)},openEnterpriseRedPacket:function(n){i(r.openEnterpriseRedPacket,it(n),n)},startSearchBeacons:function(n){i(r.startSearchBeacons,{ticket:n.ticket},n)},stopSearchBeacons:function(n){i(r.stopSearchBeacons,{},n)},onSearchBeacons:function(n){o(r.onSearchBeacons,n)},openEnterpriseChat:function(n){i("openEnterpriseChat",{useridlist:n.userIds,chatname:n.groupName},n)}},pt=1,nt={};return v.addEventListener("error",function(n){var f,t;if(!y){var i=n.target,r=i.tagName,u=i.src;if(("IMG"==r||"VIDEO"==r||"AUDIO"==r||"SOURCE"==r)&&(f=-1!=u.indexOf("wxlocalresource://"),f)){if(n.preventDefault(),n.stopPropagation(),t=i["wx-id"],t||(t=pt++,i["wx-id"]=t),nt[t])return;nt[t]=!0;wx.ready(function(){wx.getLocalImgData({localId:u,success:function(n){i.src=n.localData}})})}}},!0),v.addEventListener("load",function(n){var i,t,r;y||(i=n.target,t=i.tagName,i.src,("IMG"==t||"VIDEO"==t||"AUDIO"==t||"SOURCE"==t)&&(r=i["wx-id"],r&&(nt[r]=!1)))},!0),t&&(n.wx=n.jWeixin=a),a}});